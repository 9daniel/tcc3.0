@{
    ViewBag.Title = "Index";
    
}

<link href="~/Content/bootstrap.min.css" rel="stylesheet" />
<link href="~/Content/jquery.bootgrid.css" rel="stylesheet" />
<link href="~/Content/modal.css" rel="stylesheet" />


<style>
    .text {
        position: relative !important;
    }

    .navbar-nav {
        float: right;
    }

    .btn .caret {
        display: none;
    }

    .navbar > .container .navbar-brand {
        margin-left: auto !important;
    }
    .modal-dialog {
        left: auto !important;
    }

</style>

<div id="carouselExampleControls" class="carousel slide" data-ride="carousel">
    <div class="carousel-inner">
        <div class="carousel-item active">
            <img class="d-block w-100" src="../Assets/images/banner2.jpg" alt="First slide">
        </div>
        <div class="carousel-item">
            <img class="d-block w-100" src="../Assets/images/banner4.jpg" alt="Second slide">
        </div>
        <div class="carousel-item">
            <img class="d-block w-100" src="../Assets/images/banner5.jpg" alt="Third slide">
        </div>
    </div>
    <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="sr-only">Previous</span>
    </a>
    <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="sr-only">Next</span>
    </a>
</div>


<h2>Vagas de Estágios Disponiveis </h2>
<hr />
<p>
    @if (ViewBag.btn == true)
    {
        <a href="#" class="btn btn-danger" data-action="Create">
        <span class="glyphicon glyphicon-plus"></span>
        Nova Vaga
    </a>    
    }
    
</p>

<table id="TadaGrid" class="table table-condensed table-hover table-striped" >
    <thead>
        <tr>
            <th data-column-id="Titulo" data-order="asc">Título</th>
            <th data-column-id="diaPublicacao">Dia da publicação</th>
            <th data-column-id="dataMaxima">Data limite</th>
            <th data-column-id="empresa">Empresa</th>
            <th data-column-id="valor">Salario</th>
            <th data-formatter="acoes"></th>
        </tr>
    </thead>
</table>

<!-- Modal -->
<div class="modal fade" id="minhaModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" >
    <div class="modal-dialog" role="document" id="mod">
        <div class="modal-content">
            <div class="modal-body">
                <div id="conteudoModal"></div>
            </div>
        </div>
    </div>
</div>

@section scripts{
   <script src="~/Scripts/jquery.bootgrid.js"></script>
    <script type="text/javascript">
        var admin = '@ViewBag.btn';
        var controller = "descricaoVagas";
        $(document).ready(configurarControles);

        function configurarControles() {

            var traducao = {
                infos: "Exibindo {{ctx.start}} até {{ctx.end}} de {{ctx.total}} registros",
                loading: "Carregando, isso pode levar alguns segundos... ",
                noResults: "Não há dados para exibir",
                refresh: "Atualizar",
                search: "Pesquisar"
            };

          var grid =  $("#TadaGrid").bootgrid({
                ajax: true,
                url: "@Url.Action("Listar")",
                labels: traducao,
            searchSettings: {
                characters: 4
            },
            formatters: {
                "acoes": function (column, row) {
                    if (admin == 'True') {
                        return "<a href='#' class='btn btn-info' data-acao='Details' data-row-id='" + row.id + "'>" +
                                "<span class='glyphicon glyphicon-list'></span></a> " +
                           "<a href='#' class='btn btn-warning' data-acao='Edit' data-row-id='" + row.id + "'>" +
                           "<span class='glyphicon glyphicon-edit'></span>" +
                           "</a> " +
                           "<a href='#' class='btn btn-danger' data-acao='Delete' data-row-id='" + row.id + "'> " +
                            "<span class='glyphicon glyphicon-trash'></span></a>";
                    }
                    else {
                        return "<a href='#' class='btn btn-info' data-acao='Details' data-row-id='" + row.id + "'>" +
                                "<span class='glyphicon glyphicon-list'></span></a> ";
                    }
                }
            }
          });

            grid.on("loaded.rs.jquery.bootgrid", function () {

                grid.find("a.btn").each(function (index, elemento) {

                    var botaoDeAcao = $(elemento);

                    var acao = botaoDeAcao.data("acao");
                    var idEntidade = botaoDeAcao.data("row-id");

                    botaoDeAcao.on("click", function () {

                        abrirModal(acao, idEntidade);
                        
                    });
                });

            });


            $("a.btn").click(function () {

                var acao = $(this).data("action");

                abrirModal(acao);

            });
        }

        function abrirModal(acao, parametro) {

            var url = "/{ctrl}/{acao}/{parametro}";

            url = url.replace("{ctrl}", controller);
            url = url.replace("{acao}", acao);
            
            if (parametro != null) {
                url = url.replace("{parametro}", parametro);
            }
            else {
                url = url.replace("{parametro}", "");
            }

            $("#conteudoModal").load(url, function () {

                $("#minhaModal").modal('show');

            });


        }



        
    </script>

}

